<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö–ò–ù–û–°–†–ï–î–ê - Beer & Movie Wednesdays</title>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@400;600;700&family=Pacifico&display=swap" rel="stylesheet">
    <style>
        body { 
            font-family: 'Comfortaa', cursive; 
            background: #000000;
            overflow-x: hidden;
        }
        .logo-text { font-family: 'Pacifico', cursive; }
        
        /* Dark background */
        .bg-dark {
            background: #000000;
            position: relative;
        }
        .bg-dark::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(ellipse at 20% 0%, rgba(245, 158, 11, 0.06) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 100%, rgba(245, 158, 11, 0.04) 0%, transparent 50%);
            pointer-events: none;
            z-index: 0;
        }
        
        /* Floating particles */
        .particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
            overflow: hidden;
        }
        .particle {
            position: absolute;
            width: 3px;
            height: 3px;
            background: rgba(245, 158, 11, 0.4);
            border-radius: 50%;
            animation: floatParticle 20s infinite;
        }
        @keyframes floatParticle {
            0% { transform: translateY(0) rotate(0deg); opacity: 0; }
            5% { opacity: 0.6; }
            95% { opacity: 0.6; }
            100% { transform: translateY(-100vh) rotate(720deg); opacity: 0; }
        }
        
        /* Glowing effects */
        .glow-amber {
            box-shadow: 0 0 20px rgba(245, 158, 11, 0.2), 0 0 40px rgba(245, 158, 11, 0.1);
        }
        .text-glow {
            text-shadow: 0 0 10px rgba(245, 158, 11, 0.8), 0 0 20px rgba(245, 158, 11, 0.5), 0 0 40px rgba(245, 158, 11, 0.3);
        }
        
        /* Wednesday cell */
        .wednesday { 
            cursor: pointer; 
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative;
            overflow: hidden;
        }
        .wednesday::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: radial-gradient(circle, rgba(255,255,255,0.3) 0%, transparent 70%);
            transform: translate(-50%, -50%);
            transition: all 0.5s;
            border-radius: 50%;
        }
        .wednesday:hover::before {
            width: 200%;
            height: 200%;
        }
        .wednesday:hover { 
            transform: scale(1.1);
            z-index: 10;
        }
        
        /* Modal */
        .modal { backdrop-filter: blur(10px); }
        
        /* Logo animation */
        @keyframes float { 
            0%, 100% { transform: translateY(0); } 
            50% { transform: translateY(-8px); } 
        }
        .float { animation: float 4s ease-in-out infinite; }
        
        @keyframes pulse-glow {
            0%, 100% { filter: drop-shadow(0 0 5px rgba(245, 158, 11, 0.5)); }
            50% { filter: drop-shadow(0 0 15px rgba(245, 158, 11, 0.8)) drop-shadow(0 0 30px rgba(245, 158, 11, 0.4)); }
        }
        .pulse-glow { animation: pulse-glow 3s ease-in-out infinite; }
        
        /* Beer pouring animation */
        @keyframes pourBeer {
            0% { height: 0; y: 90; }
            100% { height: 60; y: 30; }
        }
        @keyframes pourStream {
            0%, 100% { opacity: 0; }
            20%, 80% { opacity: 1; }
        }
        .pour-beer {
            animation: pourBeer 3s ease-out infinite;
        }
        .pour-stream {
            animation: pourStream 3s ease-in-out infinite;
        }
        
        /* Beer bubbles */
        @keyframes bubble { 
            0% { transform: translateY(0) scale(0); opacity: 0; }
            20% { opacity: 0.8; }
            100% { transform: translateY(-40px) scale(1); opacity: 0; } 
        }
        .bubble { animation: bubble 2s ease-in infinite; }
        .bubble-1 { animation-delay: 0s; }
        .bubble-2 { animation-delay: 0.3s; }
        .bubble-3 { animation-delay: 0.6s; }
        .bubble-4 { animation-delay: 0.9s; }
        .bubble-5 { animation-delay: 1.2s; }
        .bubble-6 { animation-delay: 1.5s; }
        
        /* Foam animation */
        @keyframes foamGrow {
            0%, 100% { transform: scaleY(0.8); }
            50% { transform: scaleY(1); }
        }
        .foam-animate { animation: foamGrow 2s ease-in-out infinite; }
        
        /* Card animations */
        .card-hover {
            transition: all 0.3s ease;
        }
        .card-hover:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 30px rgba(0,0,0,0.5), 0 0 20px rgba(245, 158, 11, 0.1);
        }
        
        /* Slide in animation */
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .slide-in {
            animation: slideIn 0.5s ease-out forwards;
        }
        .slide-in-delay-1 { animation-delay: 0.1s; opacity: 0; }
        .slide-in-delay-2 { animation-delay: 0.2s; opacity: 0; }
        .slide-in-delay-3 { animation-delay: 0.3s; opacity: 0; }
        
        /* Button effects */
        .btn-glow {
            position: relative;
            overflow: hidden;
            transition: all 0.3s;
        }
        .btn-glow::after {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.1), transparent);
            transform: rotate(45deg) translateX(-100%);
            transition: 0.5s;
        }
        .btn-glow:hover::after {
            transform: rotate(45deg) translateX(100%);
        }
        
        /* Scrollbar */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #111; }
        ::-webkit-scrollbar-thumb { background: #f59e0b; border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: #d97706; }
        
        /* Neon text effect */
        .neon-text {
            text-shadow: 
                0 0 5px #fff,
                0 0 10px #fff,
                0 0 20px #f59e0b,
                0 0 40px #f59e0b,
                0 0 80px #f59e0b;
        }
    </style>
</head>
<body class="bg-dark min-h-screen text-white">
    <!-- Floating Particles -->
    <div class="particles" id="particles"></div>

    <!-- Logo with Beer Mug -->
    <header class="pt-8 pb-6 relative z-10">
        <div class="flex justify-center items-center">
            <svg class="w-[540px] h-36 float pulse-glow" viewBox="0 0 540 120">
                <defs>
                    <linearGradient id="beerGrad" x1="0%" y1="0%" x2="0%" y2="100%">
                        <stop offset="0%" style="stop-color:#fcd34d"/>
                        <stop offset="50%" style="stop-color:#fbbf24"/>
                        <stop offset="100%" style="stop-color:#d97706"/>
                    </linearGradient>
                    <linearGradient id="foamGrad" x1="0%" y1="0%" x2="0%" y2="100%">
                        <stop offset="0%" style="stop-color:#ffffff"/>
                        <stop offset="100%" style="stop-color:#fef3c7"/>
                    </linearGradient>
                    <linearGradient id="glassGrad" x1="0%" y1="0%" x2="100%" y2="0%">
                        <stop offset="0%" style="stop-color:rgba(255,255,255,0.1)"/>
                        <stop offset="50%" style="stop-color:rgba(255,255,255,0.3)"/>
                        <stop offset="100%" style="stop-color:rgba(255,255,255,0.1)"/>
                    </linearGradient>
                    <clipPath id="mugClip">
                        <rect x="0" y="0" width="50" height="55" rx="3"/>
                    </clipPath>
                    <filter id="glow">
                        <feGaussianBlur stdDeviation="2" result="coloredBlur"/>
                        <feMerge>
                            <feMergeNode in="coloredBlur"/>
                            <feMergeNode in="SourceGraphic"/>
                        </feMerge>
                    </filter>
                </defs>
                
                <!-- Main Title - –ö–ò–ù–û–°–†–ï–î–ê -->
                <text x="220" y="75" text-anchor="middle" class="logo-text" fill="#f59e0b" font-size="52" filter="url(#glow)">–ö–ò–ù–û–°–†–ï–î–ê</text>
                
                <!-- Beer Mug on the right -->
                <g transform="translate(448, 8)">
                    <!-- Mug body (glass) -->
                    <rect x="0" y="25" width="50" height="60" rx="5" fill="none" stroke="#b45309" stroke-width="3"/>
                    
                    <!-- Beer inside with pouring animation -->
                    <g clip-path="url(#mugClip)" transform="translate(0, 30)">
                        <rect x="0" y="55" height="0" width="50" fill="url(#beerGrad)">
                            <animate attributeName="height" from="0" to="55" dur="2.5s" fill="freeze" calcMode="spline" keySplines="0.25 0.1 0.25 1"/>
                            <animate attributeName="y" from="55" to="0" dur="2.5s" fill="freeze" calcMode="spline" keySplines="0.25 0.1 0.25 1"/>
                        </rect>
                    </g>
                    
                    <!-- Glass highlight -->
                    <rect x="6" y="30" width="6" height="50" rx="3" fill="url(#glassGrad)" opacity="0.5"/>
                    
                    <!-- Foam on top with delay -->
                    <g class="foam-animate" transform-origin="25 25" opacity="0">
                        <animate attributeName="opacity" from="0" to="1" dur="0.5s" begin="2s" fill="freeze"/>
                        <ellipse cx="25" cy="27" rx="27" ry="10" fill="url(#foamGrad)"/>
                        <circle cx="12" cy="24" r="6" fill="white" opacity="0.95"/>
                        <circle cx="28" cy="22" r="5" fill="white" opacity="0.9"/>
                        <circle cx="40" cy="25" r="5" fill="white" opacity="0.9"/>
                        <circle cx="20" cy="29" r="4" fill="white" opacity="0.8"/>
                        <circle cx="35" cy="28" r="3" fill="white" opacity="0.85"/>
                    </g>
                    
                    <!-- Handle -->
                    <path d="M50 32 Q72 32 72 55 Q72 78 50 78" fill="none" stroke="#b45309" stroke-width="5" stroke-linecap="round"/>
                    
                    <!-- Bubbles - appear after pouring starts -->
                    <g opacity="0">
                        <animate attributeName="opacity" from="0" to="1" dur="0.3s" begin="1s" fill="freeze"/>
                        <circle cx="15" cy="55" r="2.5" fill="#fef3c7" opacity="0.6" class="bubble bubble-1"/>
                        <circle cx="28" cy="65" r="2" fill="#fef3c7" opacity="0.5" class="bubble bubble-2"/>
                        <circle cx="38" cy="58" r="1.5" fill="#fef3c7" opacity="0.6" class="bubble bubble-3"/>
                        <circle cx="22" cy="72" r="1.5" fill="#fef3c7" opacity="0.5" class="bubble bubble-4"/>
                        <circle cx="33" cy="75" r="2" fill="#fef3c7" opacity="0.5" class="bubble bubble-5"/>
                        <circle cx="42" cy="70" r="1.5" fill="#fef3c7" opacity="0.6" class="bubble bubble-6"/>
                    </g>
                </g>
            </svg>
        </div>
    </header>

    <!-- Main Content - Two Column Layout -->
    <main class="container mx-auto px-4 py-6 relative z-10">
        <div class="flex flex-col lg:flex-row gap-6 max-w-7xl mx-auto">
            
            <!-- Left Column - Calendar -->
            <div class="lg:w-3/5">
                <div class="bg-black/60 backdrop-blur-sm rounded-2xl p-5 border border-amber-500/20 glow-amber slide-in slide-in-delay-1">
                    <div class="flex justify-between items-center mb-5">
                        <button onclick="prevMonth()" class="text-amber-400 hover:text-amber-300 transition p-2 hover:bg-amber-500/10 rounded-full group">
                            <svg class="w-7 h-7 transform group-hover:-translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                            </svg>
                        </button>
                        <h2 id="monthYear" class="text-2xl font-bold text-amber-400 text-glow"></h2>
                        <button onclick="nextMonth()" class="text-amber-400 hover:text-amber-300 transition p-2 hover:bg-amber-500/10 rounded-full group">
                            <svg class="w-7 h-7 transform group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                            </svg>
                        </button>
                    </div>
                    
                    <div class="grid grid-cols-7 gap-2 mb-3">
                        <div class="text-center text-gray-600 font-semibold py-2 text-sm">–ü–Ω</div>
                        <div class="text-center text-gray-600 font-semibold py-2 text-sm">–í—Ç</div>
                        <div class="text-center text-amber-400 font-bold py-2 text-sm text-glow">–°—Ä</div>
                        <div class="text-center text-gray-600 font-semibold py-2 text-sm">–ß—Ç</div>
                        <div class="text-center text-gray-600 font-semibold py-2 text-sm">–ü—Ç</div>
                        <div class="text-center text-gray-600 font-semibold py-2 text-sm">–°–±</div>
                        <div class="text-center text-gray-600 font-semibold py-2 text-sm">–í—Å</div>
                    </div>
                    
                    <div id="calendarDays" class="grid grid-cols-7 gap-2"></div>
                </div>

                <!-- Upcoming Events -->
                <div class="mt-6 bg-black/60 backdrop-blur-sm rounded-2xl p-5 border border-amber-500/20 slide-in slide-in-delay-3">
                    <h3 class="text-lg font-bold text-amber-400 mb-4 flex items-center gap-2">
                        <span class="text-xl">üé¨</span> –ë–ª–∏–∂–∞–π—à–∏–µ –≤—Å—Ç—Ä–µ—á–∏
                    </h3>
                    <div id="upcomingEvents" class="space-y-3"></div>
                </div>
            </div>

            <!-- Right Column - User Info & Event Form -->
            <div class="lg:w-2/5">
                <!-- User Name Input -->
                <div class="mb-6 slide-in slide-in-delay-2">
                    <div class="bg-black/60 backdrop-blur-sm rounded-2xl p-4 border border-amber-500/20 glow-amber card-hover">
                        <label class="text-amber-400 text-sm mb-2 block font-semibold">üë§ –í–∞—à–µ –∏–º—è:</label>
                        <input type="text" id="userName" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è" 
                            class="w-full px-4 py-3 rounded-xl bg-gray-900/80 text-white placeholder-gray-500 border border-amber-500/30 focus:outline-none focus:border-amber-400 focus:ring-2 focus:ring-amber-500/20 transition-all">
                    </div>
                </div>

                <!-- Event Details Panel (shown when date selected) -->
                <div id="eventPanel" class="hidden slide-in">
                    <div class="bg-black/60 backdrop-blur-sm rounded-2xl p-5 border border-amber-500/30 glow-amber">
                        <div class="flex justify-between items-center mb-5">
                            <h3 id="panelDate" class="text-xl font-bold text-amber-400 text-glow"></h3>
                            <button onclick="closePanel()" class="text-gray-500 hover:text-white transition hover:rotate-90 transform duration-300">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                                </svg>
                            </button>
                        </div>

                        <!-- RSVP Section -->
                        <div class="bg-gray-900/50 rounded-xl p-4 mb-4 border border-green-500/20">
                            <h4 class="text-base font-bold text-green-400 mb-3 flex items-center gap-2">
                                <span>‚úã</span> –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å —É—á–∞—Å—Ç–∏–µ
                            </h4>
                            <div class="space-y-3">
                                <div>
                                    <label class="text-gray-400 text-xs mb-1 block">–°–∫–æ–ª—å–∫–æ –ø–∏–≤–∞ –ø—Ä–∏–Ω–µ—Å—ë—Ç–µ? üç∫</label>
                                    <input type="number" id="beerCount" min="0" max="99" value="2"
                                        class="w-full px-3 py-2 rounded-lg bg-gray-800/50 text-white border border-amber-500/30 focus:outline-none focus:border-amber-400 transition text-sm">
                                </div>
                                <button onclick="confirmAttendance()" 
                                    class="w-full btn-glow bg-gradient-to-r from-green-600 to-green-500 hover:from-green-500 hover:to-green-400 text-white font-bold py-2 px-4 rounded-xl transition transform hover:scale-[1.02] shadow-lg shadow-green-500/20">
                                    –Ø –ø—Ä–∏–¥—É! üéâ
                                </button>
                            </div>
                            
                            <!-- Attendees List -->
                            <div class="mt-4">
                                <h5 class="text-gray-400 text-xs mb-2">–ö—Ç–æ –ø—Ä–∏–¥—ë—Ç:</h5>
                                <div id="attendeesList" class="flex flex-wrap gap-2"></div>
                            </div>
                        </div>

                        <!-- Movie Suggestions -->
                        <div class="bg-gray-900/50 rounded-xl p-4 mb-4 border border-purple-500/20">
                            <h4 class="text-base font-bold text-purple-400 mb-3 flex items-center gap-2">
                                <span>üé¨</span> –ü—Ä–µ–¥–ª–æ–∂–∏—Ç—å —Ñ–∏–ª—å–º
                            </h4>
                            <div class="flex gap-2 mb-3">
                                <input type="text" id="movieInput" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ —Ñ–∏–ª—å–º–∞..."
                                    class="flex-1 px-3 py-2 rounded-lg bg-gray-800/50 text-white placeholder-gray-500 border border-purple-500/30 focus:outline-none focus:border-purple-400 transition text-sm">
                                <button onclick="addMovie()" 
                                    class="btn-glow bg-gradient-to-r from-purple-600 to-purple-500 hover:from-purple-500 hover:to-purple-400 text-white font-bold py-2 px-3 rounded-lg transition transform hover:scale-105 text-sm">
                                    +
                                </button>
                            </div>
                            
                            <!-- Movies List with Voting -->
                            <div id="moviesList" class="space-y-2 max-h-48 overflow-y-auto"></div>
                        </div>

                        <!-- Total Beer -->
                        <div class="bg-gradient-to-r from-amber-600 to-yellow-500 rounded-xl p-4 text-center relative overflow-hidden">
                            <div class="absolute inset-0 bg-gradient-to-r from-transparent via-white/10 to-transparent animate-pulse"></div>
                            <div class="text-4xl mb-1 relative">üç∫</div>
                            <div class="text-gray-900 font-bold relative text-sm">–í—Å–µ–≥–æ –ø–∏–≤–∞: <span id="totalBeer" class="text-2xl">0</span> —à—Ç.</div>
                        </div>
                    </div>
                </div>

                <!-- Placeholder when no date selected -->
                <div id="eventPlaceholder" class="slide-in slide-in-delay-2">
                    <div class="bg-black/40 backdrop-blur-sm rounded-2xl p-8 border border-gray-800 text-center">
                        <div class="text-5xl mb-4 opacity-50">üìÖ</div>
                        <p class="text-gray-500 text-sm">–í—ã–±–µ—Ä–∏—Ç–µ —Å—Ä–µ–¥—É –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ,<br>—á—Ç–æ–±—ã –æ—Ç–∫—Ä—ã—Ç—å –¥–µ—Ç–∞–ª–∏ –≤—Å—Ç—Ä–µ—á–∏</p>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Setup Modal -->
    <div id="setupModal" class="modal fixed inset-0 bg-black/90 hidden items-center justify-center z-50 p-4">
        <div class="bg-gray-950 rounded-2xl max-w-lg w-full p-6 border border-amber-500/30">
            <h3 class="text-xl font-bold text-amber-400 mb-4">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Firebase</h3>
            <p class="text-gray-400 mb-4 text-sm">–î–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏, –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ Firebase:</p>
            <div class="bg-black rounded-xl p-4 mb-4 border border-gray-800">
                <pre class="text-green-400 text-xs overflow-x-auto"><code>1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ firebase.google.com
2. –°–æ–∑–¥–∞–π—Ç–µ –ø—Ä–æ–µ–∫—Ç
3. –°–æ–∑–¥–∞–π—Ç–µ Realtime Database
4. –í –ø—Ä–∞–≤–∏–ª–∞—Ö —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ:
   {
     "rules": {
       ".read": true,
       ".write": true
     }
   }
5. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –Ω–∏–∂–µ</code></pre>
            </div>
            <textarea id="firebaseConfig" placeholder='{"apiKey": "...", "databaseURL": "..."}'
                class="w-full px-4 py-2 rounded-xl bg-gray-900 text-white placeholder-gray-500 border border-amber-500/30 focus:outline-none focus:border-amber-400 h-32 text-sm mb-4"></textarea>
            <div class="flex gap-2">
                <button onclick="saveFirebaseConfig()" class="flex-1 btn-glow bg-gradient-to-r from-green-600 to-green-500 hover:from-green-500 hover:to-green-400 text-white font-bold py-2 px-4 rounded-xl transition">
                    –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
                </button>
                <button onclick="closeSetupModal()" class="flex-1 btn-glow bg-gradient-to-r from-gray-700 to-gray-600 hover:from-gray-600 hover:to-gray-500 text-white font-bold py-2 px-4 rounded-xl transition">
                    –ó–∞–∫—Ä—ã—Ç—å
                </button>
            </div>
            <div class="mt-4 text-center">
                <a href="setup.html" class="text-amber-400 hover:text-amber-300 text-sm underline">üìñ –ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ</a>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="text-center py-6 text-gray-700 text-xs relative z-10">
        <p>üç∫ –ö–ò–ù–û–°–†–ï–î–ê ¬© 2025 ‚Ä¢ –°–¥–µ–ª–∞–Ω–æ —Å –ª—é–±–æ–≤—å—é –∫ –ø–∏–≤—É –∏ –∫–∏–Ω–æ üé¨</p>
    </footer>

    <script>
        // Create floating particles
        function createParticles() {
            const container = document.getElementById('particles');
            for (let i = 0; i < 15; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.bottom = '-10px';
                particle.style.animationDelay = Math.random() * 15 + 's';
                particle.style.animationDuration = (20 + Math.random() * 15) + 's';
                container.appendChild(particle);
            }
        }
        createParticles();

        // State
        let currentDate = new Date();
        let selectedDate = null;
        let db = null;
        let useFirebase = false;
        let data = { events: {} };

        const monthNames = ['–Ø–Ω–≤–∞—Ä—å', '–§–µ–≤—Ä–∞–ª—å', '–ú–∞—Ä—Ç', '–ê–ø—Ä–µ–ª—å', '–ú–∞–π', '–ò—é–Ω—å', 
                           '–ò—é–ª—å', '–ê–≤–≥—É—Å—Ç', '–°–µ–Ω—Ç—è–±—Ä—å', '–û–∫—Ç—è–±—Ä—å', '–ù–æ—è–±—Ä—å', '–î–µ–∫–∞–±—Ä—å'];

        // Firebase Configuration (hardcoded)
        const firebaseConfig = {
            apiKey: "AIzaSyBwp4ZNbJuUM5sY0qMffvZTHr2PDvc2iLc",
            authDomain: "kinosreda-ce8ef.firebaseapp.com",
            databaseURL: "https://kinosreda-ce8ef-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "kinosreda-ce8ef",
            storageBucket: "kinosreda-ce8ef.firebasestorage.app",
            messagingSenderId: "889337905300",
            appId: "1:889337905300:web:325aea2f3fb3c6b44a7481",
            measurementId: "G-MGW6GF67H3"
        };

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            const savedName = localStorage.getItem('userName');
            if (savedName) document.getElementById('userName').value = savedName;
            
            document.getElementById('userName').addEventListener('change', (e) => {
                localStorage.setItem('userName', e.target.value);
            });

            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Firebase
            initFirebase(firebaseConfig);
        });
        
        // Open Settings (from footer only)
        function openSettings() {
            const savedConfig = localStorage.getItem('firebaseConfig');
            if (savedConfig) {
                document.getElementById('firebaseConfig').value = savedConfig;
            }
            document.getElementById('setupModal').classList.remove('hidden');
            document.getElementById('setupModal').classList.add('flex');
        }

        // Firebase Methods
        function initFirebase(config) {
            try {
                if (!firebase.apps.length) {
                    firebase.initializeApp(config);
                }
                db = firebase.database();
                useFirebase = true;
                
                db.ref('events').on('value', (snapshot) => {
                    data.events = snapshot.val() || {};
                    renderCalendar();
                    renderUpcomingEvents();
                    if (selectedDate) renderPanelContent();
                });
                
                console.log('Firebase connected!');
            } catch (e) {
                console.error('Firebase error:', e);
                const savedData = localStorage.getItem('eventData');
                if (savedData) data = JSON.parse(savedData);
                renderCalendar();
                renderUpcomingEvents();
            }
        }

        function saveFirebaseConfig() {
            const configText = document.getElementById('firebaseConfig').value;
            try {
                const config = JSON.parse(configText);
                localStorage.setItem('firebaseConfig', configText);
                initFirebase(config);
                closeSetupModal();
            } catch (e) {
                alert('–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏');
            }
        }

        function closeSetupModal() {
            document.getElementById('setupModal').classList.add('hidden');
            document.getElementById('setupModal').classList.remove('flex');
        }

        // Data Methods
        function saveData() {
            if (useFirebase && db) {
                db.ref('events').set(data.events);
            } else {
                localStorage.setItem('eventData', JSON.stringify(data));
                renderCalendar();
                renderUpcomingEvents();
            }
        }

        function getEvent(dateKey) {
            return data.events[dateKey] || { attendees: {}, movies: {} };
        }

        function setEvent(dateKey, event) {
            data.events[dateKey] = event;
            saveData();
        }

        // Calendar Methods
        function renderCalendar() {
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();
            
            document.getElementById('monthYear').textContent = `${monthNames[month]} ${year}`;
            
            const firstDay = new Date(year, month, 1);
            const lastDay = new Date(year, month + 1, 0);
            const startDay = (firstDay.getDay() + 6) % 7;
            
            const container = document.getElementById('calendarDays');
            container.innerHTML = '';
            
            for (let i = 0; i < startDay; i++) {
                container.innerHTML += '<div></div>';
            }
            
            for (let day = 1; day <= lastDay.getDate(); day++) {
                const date = new Date(year, month, day);
                const isWednesday = date.getDay() === 3;
                const dateKey = formatDateKey(date);
                const event = getEvent(dateKey);
                const hasAttendees = Object.keys(event.attendees || {}).length > 0;
                const today = new Date();
                today.setHours(0, 0, 0, 0);
                const dateNoTime = new Date(year, month, day);
                const isToday = dateNoTime.getTime() === today.getTime();
                const isPast = dateNoTime < today;
                const isSelected = selectedDate === dateKey;
                
                let classes = 'h-12 rounded-lg flex flex-col items-center justify-center text-center relative ';
                
                if (isWednesday && !isPast) {
                    classes += 'wednesday bg-gradient-to-br from-amber-500 to-amber-600 hover:from-amber-400 hover:to-amber-500 text-gray-900 font-bold shadow-lg shadow-amber-500/20 ';
                    if (hasAttendees) classes += 'ring-2 ring-green-400 ring-offset-1 ring-offset-black ';
                    if (isToday) classes += 'ring-2 ring-white ring-offset-1 ring-offset-black ';
                    if (isSelected) classes += 'ring-2 ring-amber-300 ring-offset-2 ring-offset-black scale-110 ';
                } else if (isWednesday && isPast) {
                    classes += 'bg-gray-900/50 text-amber-700/50 border border-amber-900/20 ';
                } else {
                    classes += 'text-gray-700 ';
                }
                
                const attendeeCount = Object.keys(event.attendees || {}).length;
                
                container.innerHTML += `
                    <div class="${classes}" ${isWednesday && !isPast ? `onclick="openPanel('${dateKey}')"` : ''}>
                        <span class="text-sm font-bold">${day}</span>
                        ${hasAttendees ? `<span class="text-xs">${attendeeCount}üë•</span>` : ''}
                    </div>
                `;
            }
        }

        function prevMonth() {
            currentDate.setMonth(currentDate.getMonth() - 1);
            renderCalendar();
        }

        function nextMonth() {
            currentDate.setMonth(currentDate.getMonth() + 1);
            renderCalendar();
        }

        function formatDateKey(date) {
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            return `${year}-${month}-${day}`;
        }

        function formatDateDisplay(dateKey) {
            const [year, month, day] = dateKey.split('-').map(Number);
            const date = new Date(year, month - 1, day);
            return date.toLocaleDateString('ru-RU', { 
                weekday: 'long', 
                day: 'numeric', 
                month: 'long'
            });
        }

        // Panel Methods
        function openPanel(dateKey) {
            const userName = document.getElementById('userName').value.trim();
            if (!userName) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è!');
                document.getElementById('userName').focus();
                return;
            }
            
            selectedDate = dateKey;
            document.getElementById('panelDate').textContent = formatDateDisplay(dateKey);
            
            document.getElementById('eventPlaceholder').classList.add('hidden');
            document.getElementById('eventPanel').classList.remove('hidden');
            
            renderPanelContent();
            renderCalendar();
        }

        function closePanel() {
            selectedDate = null;
            document.getElementById('eventPanel').classList.add('hidden');
            document.getElementById('eventPlaceholder').classList.remove('hidden');
            renderCalendar();
        }

        function renderPanelContent() {
            const event = getEvent(selectedDate);
            const userName = document.getElementById('userName').value.trim();
            
            const attendeesContainer = document.getElementById('attendeesList');
            const attendees = event.attendees || {};
            
            if (Object.keys(attendees).length === 0) {
                attendeesContainer.innerHTML = '<span class="text-gray-600 text-xs italic">–ü–æ–∫–∞ –Ω–∏–∫—Ç–æ –Ω–µ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª...</span>';
            } else {
                attendeesContainer.innerHTML = Object.entries(attendees).map(([name, info]) => `
                    <div class="bg-green-600/20 px-3 py-1.5 rounded-full flex items-center gap-1.5 border border-green-500/30 text-sm">
                        <span class="text-white font-medium">${name}</span>
                        <span class="text-amber-300 font-bold text-xs">üç∫${info.beer}</span>
                        ${name === userName ? `<button onclick="removeAttendance('${name}')" class="text-red-400 hover:text-red-300 ml-1 text-xs">‚úï</button>` : ''}
                    </div>
                `).join('');
            }
            
            if (attendees[userName]) {
                document.getElementById('beerCount').value = attendees[userName].beer;
            }
            
            const totalBeer = Object.values(attendees).reduce((sum, a) => sum + (parseInt(a.beer) || 0), 0);
            document.getElementById('totalBeer').textContent = totalBeer;
            
            const moviesContainer = document.getElementById('moviesList');
            const movies = event.movies || {};
            
            if (Object.keys(movies).length === 0) {
                moviesContainer.innerHTML = '<p class="text-gray-600 text-xs text-center italic py-3">–ü–æ–∫–∞ –Ω–µ—Ç –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π...</p>';
            } else {
                const sortedMovies = Object.entries(movies).sort((a, b) => 
                    (Object.keys(b[1].votes || {}).length) - (Object.keys(a[1].votes || {}).length)
                );
                
                moviesContainer.innerHTML = sortedMovies.map(([id, movie], index) => {
                    const votes = Object.keys(movie.votes || {});
                    const hasVoted = votes.includes(userName);
                    const isAuthor = movie.author === userName;
                    const isLeader = index === 0 && votes.length > 0;
                    
                    return `
                        <div class="bg-gray-800/30 rounded-lg p-2.5 flex items-center gap-2 border ${isLeader ? 'border-amber-500/50 glow-amber' : 'border-gray-700/30'} transition-all hover:bg-gray-800/50">
                            <button onclick="voteMovie('${id}')" 
                                class="w-10 h-10 rounded-lg ${hasVoted ? 'bg-gradient-to-br from-amber-500 to-amber-600 shadow shadow-amber-500/30' : 'bg-gray-700/50 hover:bg-gray-600/50'} flex flex-col items-center justify-center transition-all transform hover:scale-105">
                                <span class="text-sm">${hasVoted ? 'üëç' : 'üëÜ'}</span>
                                <span class="text-xs text-white font-bold">${votes.length}</span>
                            </button>
                            <div class="flex-1 min-w-0">
                                <div class="text-white font-medium text-sm truncate">
                                    ${isLeader ? 'üëë ' : ''}${movie.title}
                                </div>
                                <div class="text-gray-500 text-xs truncate">${movie.author}</div>
                            </div>
                            ${isAuthor ? `<button onclick="removeMovie('${id}')" class="text-red-400/60 hover:text-red-400 p-1 text-sm">üóëÔ∏è</button>` : ''}
                        </div>
                    `;
                }).join('');
            }
        }

        // Event Actions
        function confirmAttendance() {
            const userName = document.getElementById('userName').value.trim();
            const beerCount = parseInt(document.getElementById('beerCount').value) || 0;
            
            if (!userName) {
                alert('–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è!');
                return;
            }
            
            const event = getEvent(selectedDate);
            if (!event.attendees) event.attendees = {};
            event.attendees[userName] = { beer: beerCount, timestamp: Date.now() };
            setEvent(selectedDate, event);
            
            if (!useFirebase) renderPanelContent();
        }

        function removeAttendance(name) {
            const event = getEvent(selectedDate);
            if (event.attendees && event.attendees[name]) {
                delete event.attendees[name];
                setEvent(selectedDate, event);
                if (!useFirebase) renderPanelContent();
            }
        }

        function addMovie() {
            const userName = document.getElementById('userName').value.trim();
            const movieInput = document.getElementById('movieInput');
            const title = movieInput.value.trim();
            
            if (!title) return;
            
            const event = getEvent(selectedDate);
            if (!event.movies) event.movies = {};
            
            const movieId = Date.now().toString();
            event.movies[movieId] = {
                title: title,
                author: userName,
                votes: { [userName]: true },
                timestamp: Date.now()
            };
            
            setEvent(selectedDate, event);
            movieInput.value = '';
            
            if (!useFirebase) renderPanelContent();
        }

        function voteMovie(movieId) {
            const userName = document.getElementById('userName').value.trim();
            const event = getEvent(selectedDate);
            
            if (!event.movies || !event.movies[movieId]) return;
            
            if (!event.movies[movieId].votes) event.movies[movieId].votes = {};
            
            if (event.movies[movieId].votes[userName]) {
                delete event.movies[movieId].votes[userName];
            } else {
                event.movies[movieId].votes[userName] = true;
            }
            
            setEvent(selectedDate, event);
            if (!useFirebase) renderPanelContent();
        }

        function removeMovie(movieId) {
            const event = getEvent(selectedDate);
            if (event.movies && event.movies[movieId]) {
                delete event.movies[movieId];
                setEvent(selectedDate, event);
                if (!useFirebase) renderPanelContent();
            }
        }

        // Upcoming Events
        function renderUpcomingEvents() {
            const container = document.getElementById('upcomingEvents');
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            
            const upcoming = Object.entries(data.events)
                .filter(([dateKey, event]) => {
                    const [year, month, day] = dateKey.split('-').map(Number);
                    const date = new Date(year, month - 1, day);
                    return date >= today && Object.keys(event.attendees || {}).length > 0;
                })
                .sort((a, b) => {
                    const [aY, aM, aD] = a[0].split('-').map(Number);
                    const [bY, bM, bD] = b[0].split('-').map(Number);
                    return new Date(aY, aM - 1, aD) - new Date(bY, bM - 1, bD);
                })
                .slice(0, 3);
            
            if (upcoming.length === 0) {
                container.innerHTML = '<p class="text-gray-600 text-center italic py-4 text-sm">–ù–µ—Ç –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –≤—Å—Ç—Ä–µ—á</p>';
                return;
            }
            
            container.innerHTML = upcoming.map(([dateKey, event]) => {
                const attendees = Object.entries(event.attendees || {});
                const totalBeer = attendees.reduce((sum, [, a]) => sum + (parseInt(a.beer) || 0), 0);
                
                // –ù–∞–π—Ç–∏ —Ñ–∏–ª—å–º-–ª–∏–¥–µ—Ä —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —É –Ω–µ–≥–æ –µ—Å—Ç—å –≥–æ–ª–æ—Å–∞
                const moviesWithVotes = Object.entries(event.movies || {})
                    .filter(([, movie]) => Object.keys(movie.votes || {}).length > 0)
                    .sort((a, b) => Object.keys(b[1].votes || {}).length - Object.keys(a[1].votes || {}).length);
                const topMovie = moviesWithVotes.length > 0 ? moviesWithVotes[0] : null;
                
                return `
                    <div onclick="openPanel('${dateKey}')" 
                        class="bg-gray-900/50 hover:bg-gray-800/50 rounded-xl p-3 cursor-pointer transition-all border border-amber-500/10 hover:border-amber-500/30 card-hover group">
                        <div class="flex justify-between items-start">
                            <div>
                                <div class="text-amber-400 font-semibold text-sm group-hover:text-glow transition-all">${formatDateDisplay(dateKey)}</div>
                                <div class="text-gray-500 text-xs mt-1">
                                    üë• ${attendees.length} ‚Ä¢ üç∫ ${totalBeer}
                                </div>
                                ${topMovie ? `<div class="text-purple-400/70 text-xs mt-1 truncate max-w-[200px]">üé¨ ${topMovie[1].title}</div>` : ''}
                            </div>
                            <div class="text-2xl opacity-30 group-hover:opacity-70 transition-all">üé¨</div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Enter key for movie input
        document.addEventListener('keypress', (e) => {
            if (e.key === 'Enter' && e.target.id === 'movieInput') addMovie();
        });
    </script>
</body>
</html>